<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sano Betting Tips</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<style>

/* ===== GLOBAL ===== */
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #0f172a, #1e293b);
  color: #fff;
}

/* ===== HEADER ===== */
.header {
  position: fixed;
  top: 0;
  width: 100%;
  background: rgba(15, 23, 42, 0.95);
  backdrop-filter: blur(10px);
  padding: 18px 10px 12px;
  text-align: center;
  z-index: 1000;
}

.header h1 {
  margin: 0 0 12px;
  font-size: 22px;
  font-weight: 700;
  background: linear-gradient(90deg,#facc15,#f59e0b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* ===== CATEGORY MENU ===== */
.category-nav {
  display: flex;
  justify-content: space-around;
}

.category-btn {
  background: none;
  border: none;
  color: #94a3b8;
  font-size: 13px;
  font-weight: 600;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  padding: 6px;
  transition: 0.3s;
}

.category-btn i {
  font-size: 18px;
}

.category-btn.active {
  color: #facc15;
}

/* ===== CONTENT ===== */
#predictions {
  padding: 150px 15px 40px;
}

/* ===== DATE HEADER ===== */
.date-header {
  margin-top: 25px;
  font-weight: 700;
  color: #facc15;
  font-size: 14px;
}

/* ===== CARD ===== */
.prediction-card {
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(10px);
  padding: 15px;
  margin-top: 12px;
  border-radius: 14px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from {opacity:0; transform: translateY(10px);}
  to {opacity:1; transform: translateY(0);}
}

.card-top {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: #94a3b8;
  margin-bottom: 10px;
}

.teams {
  display: flex;
  justify-content: space-between;
  font-weight: 600;
  margin-bottom: 10px;
}

.vs {
  color: #facc15;
}

.card-bottom {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.prediction-text {
  font-size: 15px;
  font-weight: 600;
}

.odds-box {
  display: flex;
  align-items: center;
  gap: 6px;
}

.odds {
  font-weight: 700;
  color: #10b981;
}

.status {
  font-size: 10px;
}

.status.win { color: #10b981; }
.status.lose { color: #ef4444; }
.status.pending { color: #facc15; }

/* ===== LOADING ===== */
.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(255,255,255,0.1);
  border-top: 4px solid #facc15;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 60px auto;
}

@keyframes spin {
  100% { transform: rotate(360deg); }
}

.empty-msg, .error-msg {
  text-align: center;
  padding: 30px;
  color: #94a3b8;
}

</style>
</head>
<body>

<header class="header">
  <h1>Sano Betting Tips</h1>

  <div class="category-nav">
    <button class="category-btn active" data-category="free">
      <i class="bi bi-circle-fill"></i>
      Free
    </button>

    <button class="category-btn" data-category="safe">
      <i class="bi bi-shield-fill"></i>
      Safe
    </button>

    <button class="category-btn" data-category="fixed">
      <i class="bi bi-star-fill"></i>
      Fixed
    </button>
  </div>
</header>

<main id="predictions">
  <div class="loading-spinner"></div>
</main>

<!-- ===== FIREBASE + APP SCRIPT ===== -->
<script type="module">

// üî• 1Ô∏è‚É£ IMPORT FIREBASE
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// üî• 2Ô∏è‚É£ YOUR FIREBASE CONFIG (PUT YOUR REAL CONFIG HERE)
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

// üî• 3Ô∏è‚É£ INITIALIZE
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// üî• 4Ô∏è‚É£ FETCH MATCHES
async function getMatches() {
  const querySnapshot = await getDocs(collection(db, "matches"));
  const matches = [];
  querySnapshot.forEach(doc => {
    matches.push(doc.data());
  });
  return matches;
}

// --------------------- UI LOGIC ---------------------
const predictionsContainer = document.getElementById("predictions");
const categoryButtons = document.querySelectorAll(".category-btn");
let currentCategory = "free";

const statusIcons = {
  pending: `<span class="status pending">‚óè</span>`,
  win: `<span class="status win">‚óè</span>`,
  lose: `<span class="status lose">‚óè</span>`
};

function getStatusIcon(status){
    if(!status) return statusIcons.pending;
    const s = status.toLowerCase();
    if(["win","won"].includes(s)) return statusIcons.win;
    if(["lose","lost"].includes(s)) return statusIcons.lose;
    return statusIcons.pending;
}

async function renderPredictions(category){
  currentCategory = category;
  predictionsContainer.innerHTML = `<div class="loading-spinner"></div>`;

  try{
    const predictions = await getMatches();

    const filtered = predictions.filter(
      p => (p.category || "").toLowerCase() === category.toLowerCase()
    );

    filtered.sort((a,b)=> new Date(b.date) - new Date(a.date));

    predictionsContainer.innerHTML = "";

    if(!filtered.length){
      predictionsContainer.innerHTML =
        "<div class='empty-msg'>No matches available.</div>";
      return;
    }

    let lastDate = null;

    filtered.forEach(p => {
      const matchDate = new Date(p.date);
      const dateString =
        matchDate.getDate().toString().padStart(2,'0') + " " +
        matchDate.toLocaleString('default', {month:'short'}) + " " +
        matchDate.getFullYear();

      if(dateString !== lastDate){
        const dateHeader = document.createElement("div");
        dateHeader.className = "date-header";
        dateHeader.textContent = dateString;
        predictionsContainer.appendChild(dateHeader);
        lastDate = dateString;
      }

      const oddsValue = Number(p.odds || 0);

      const card = document.createElement("div");
      card.className = "prediction-card";
      card.innerHTML = `
        <div class="card-top">
          <span>${p.league || "-"}</span>
          <span>${matchDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
        </div>

        <div class="teams">
          <span>${p.homeTeam || "Home"}</span>
          <span class="vs">VS</span>
          <span>${p.awayTeam || "Away"}</span>
        </div>

        <div class="card-bottom">
          <div>
            <small>Prediction</small>
            <div class="prediction-text">${p.prediction || "-"}</div>
          </div>

          <div class="odds-box">
            ${getStatusIcon(p.status)}
            <span class="odds">${oddsValue.toFixed(2)}</span>
          </div>
        </div>
      `;

      predictionsContainer.appendChild(card);
    });

  }catch(err){
    console.error(err);
    predictionsContainer.innerHTML =
      "<div class='error-msg'>Error loading matches.</div>";
  }
}

// CATEGORY CLICK
categoryButtons.forEach(btn => {
  btn.addEventListener("click", () => {
    categoryButtons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    renderPredictions(btn.dataset.category);
  });
});

// INITIAL LOAD
renderPredictions(currentCategory);

</script>

</body>
</html>
